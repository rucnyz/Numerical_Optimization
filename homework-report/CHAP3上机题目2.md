# 数值优化方法第二次上机作业
## 1. 实验报告

本实验报告将说明个人全部代码文件内容和结果，并对结果进行简要分析。

### 1.1. 使用语言及依赖

- `python`>=3.8
- `sympy`~=1.9
- `numpy`~=1.21.4
- `matplotlib`~=3.5

### 1.2. 代码文件结构

- `Discrete_boundary_value.py`：为`Discrete_boundary_value`函数提供python实现函数`DBV()`。
- `Watson.py`：为`Watson`函数提供python实现函数`Watson()`。
- `methods.py`：内含本实验用到的所有求导和算法。
  - `get_gradient()`：获得函数一阶偏导。
  - `get_Hessan()`：获得函数二阶导（海塞矩阵）。
  - `golden_search()`：对给定区间进行黄金分割搜索步长。
  - `damped_newton()`：阻尼牛顿法实现。
  - `modified_newton()`：修正牛顿法实现。
  - `quasi_newton()`：拟牛顿法实现，包括`SR1`、`DFP`、`BFGS`方法。
- `utils.py`：包装函数初始化和算法的调用，方便测试。
  - `get_fun()`：得到原函数、导数、海塞矩阵表达式，提供两种原函数选择：`Watson`和`DBV`。
  - `algo_display()`：将定义好的函数在每种算法中运行并储存以及输出结果。
- `run.ipynb`最终的测试结果，接下来将主要介绍此文件中的结果。
  
### 1.3. 实验设置
我对题目所给的两个函数分别在五个牛顿优化算法(阻尼、修正、SR1、DFP、BFGS)上进行测试，使用黄金分割法搜索求步长，终止条件为$||gk||_2<\epsilon$，为方便收敛，$\epsilon$取1e-2。最大迭代次数设置为5000，n分别设置为5和10，下为测试结果。

由于实验中阻尼牛顿法均会遇到海塞矩阵奇异的问题，故不再展示。
### 1.4. 实验结果

- $n=5$
  
|  算法名称  	| 使用函数(watson) 	| 总时间(watson) 	| 平均时间(watson) 	| 使用函数(DBV) 	| 总时间(DBV) 	| 平均时间(DBV) 	|
|:----------:	|:----------------:	|:--------------:	|:----------------:	|:-------------:	|:-----------:	|:-------------:	|
| 修正牛顿法 	|       3603       	|    97.1596s    	|       0.027s      	|      100      	|   0.1840s   	|    0.00184s    	|
|     SR1    	|        12        	|     0.1680s    	|       0.014s      	|       5       	|   0.0080s   	|     0.0016s    	|
|     DFP    	|        47        	|     0.6202s    	|       0.013s      	|       5       	|   0.0080s   	|     0.0016s    	|
|    BFGS    	|        15        	|     0.2121s    	|       0.014s      	|       4       	|   0.0040s   	|     0.001s     	|
![watson](watson5.png)
![dbv](dbv5.png)
- $n=10$

|  算法名称  	| 使用函数(watson) 	| 总时间(watson) 	| 平均时间(watson) 	| 使用函数(DBV) 	| 总时间(DBV) 	| 平均时间(DBV) 	|
|:----------:	|:----------------:	|:--------------:	|:----------------:	|:-------------:	|:-----------:	|:-------------:	|
| 修正牛顿法 	|       2149       	|    284.7774s   	|      0.1325      	|      168      	|   0.5470s   	|     0.0033    	|
|     SR1    	|        21        	|     0.6532s    	|       0.031      	|       10      	|   0.0330s   	|     0.0033    	|
|     DFP    	|        71        	|     2.1545s    	|       0.030      	|       32      	|   0.0920s   	|     0.0029    	|
|    BFGS    	|        20        	|     0.6319s    	|       0.032      	|       12      	|   0.0360s   	|     0.003     	|    	|
![watson](watson10.png)
![dbv](dbv10.png)
结果基本表明，拟牛顿法的收敛速度远快于修正牛顿法，而

### 1.5. 实验备注
我在实现拟牛顿法时，开始我使用$Bk$进行迭代